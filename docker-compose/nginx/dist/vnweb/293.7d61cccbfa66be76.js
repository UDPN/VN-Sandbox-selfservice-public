"use strict";(self.webpackChunkudpn_tem2=self.webpackChunkudpn_tem2||[]).push([[293],{8293:(le,D,r)=>{r.r(D),r.d(D,{MemebershipModule:()=>pe});var T=r(9808),E=r(3767),S=r(8776),J=r(8554),k=r(7322),V=r(4975),Y=r(1237),Q=r(6556),u=r(1062),y=r(5089),w=r(655),x=r(3075),C=r(6661),l=r(8746),h=r(1422),A=r(2192),F=r(4842),e=r(5e3),G=r(2290),L=r(72),I=r(8966),j=r(4350),d=r(4004);let m=(()=>{class n{}return n.list="v1/udpn/member/node/manager/searchs",n.getNodeCode="v1/udpn/member/node/code/manage/search",n.add="v1/udpn/member/node/manager/save",n.info="v1/udpn/member/node/manager/detail/search",n.edit="v1/udpn/member/node/manager/edit",n.submit="v1/udpn/member/node/manager/submit",n.delete="v1/udpn/member/node/manager/remove",n.applyExit="v1/udpn/member/node/manager/apply/exited",n.exit="v1/udpn/member/node/manager/exited",n.country="v1/udpn/member/common/search/country",n.license="v1/udpn/member/node/manager/upload/license",n.downloadLicense="v1/udpn/member/common/file/download",n})();var z=r(520);let P=(()=>{class n{constructor(t){this.http=t}list(t){return this.http.post(m.list,{key:t.key||"",bizSN:t.bizSN||"",nodeName:t.nodeName||"",nodeCode:t.nodeCode||"",nodeType:t.nodeType||0,nodeTitle:t.nodeTitle||"",remark:t.remark||"",status:t.status||"",createDate:t.createDate||"",updateDate:t.updateDate||"",endDate:t.endDate||"",startDate:t.startDate||"",fromVn:t.fromVn||"",inPage:t.inPage||{pageSize:10,pageNum:1}}).pipe((0,d.U)(a=>a))}getNodeCode(t){return this.http.post(m.getNodeCode,{nodeType:t.nodeType||""}).pipe((0,d.U)(a=>a))}add(t){return this.http.post(m.add,{udpnDidDocument:t.udpnDidDocument,udpnPeerNo:t.udpnPeerNo,udpnPeerName:t.udpnPeerName,udpnPeerType:t.udpnPeerType||1,udpnPeerTitle:t.udpnPeerTitle,udpnPeerDesc:t.udpnPeerDesc,nodeCreateType:t.nodeCreateType||0,nodeEmail:t.nodeEmail,chainMemberAddr:t.chainMemberAddr||"",chainMemberContact:t.chainMemberContact||"",chainMemberLicense:t.chainMemberLicense||"",countryId:t.country||"",chainMemberPhone:t.chainMemberPhone||"",chainMemberUrl:t.chainMemberUrl||""}).pipe((0,d.U)(a=>a))}info(t){return this.http.post(m.info,{udpnNodeCode:t.udpnDid||""}).pipe((0,d.U)(a=>a))}edit(t){return this.http.post(m.edit,{udpnDid:t.udpnDid||"",udpnPeerNo:t.udpnPeerNo||"",udpnPeerName:t.udpnPeerName||"",udpnPeerType:t.udpnPeerType||"",udpnPeerTitle:t.udpnPeerTitle||"",udpnPeerDesc:t.udpnPeerDesc||"",udpnDidDoc:t.udpnDidDocument||"",nodeEmail:t.nodeEmail||"",chainMemberAddr:t.chainMemberAddr||"",chainMemberContact:t.chainMemberContact||"",chainMemberLicense:t.chainMemberLicense||"",countryId:t.country||"",chainMemberPhone:t.chainMemberPhone||"",chainMemberUrl:t.chainMemberUrl||""}).pipe((0,d.U)(a=>a))}submit(t){return this.http.post(m.submit,{udpnNodeCode:t.udpnNodeCode||""}).pipe((0,d.U)(a=>a))}delete(t){return this.http.post(m.delete,{udpnNodeCode:t.udpnDid||""}).pipe((0,d.U)(a=>a))}applyExit(t){return this.http.post(m.applyExit,{nodeCode:t.nodeCode||"",applyReason:t.applyReason||""}).pipe((0,d.U)(a=>a))}exit(t){return this.http.post(m.exit,{nodeCode:t.nodeCode||""}).pipe((0,d.U)(a=>a))}getCountry(t){return this.http.post(m.country,{}).pipe((0,d.U)(a=>a))}getLicense(t){return this.http.post(m.license,{}).pipe((0,d.U)(a=>a))}setLicense(t){return this.http.post(m.downloadLicense,{hash:t.hash||""}).pipe((0,d.U)(a=>a))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(z.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var U=r(2214),M=r(7423);function $(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().submit()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.form.valid||!t.contactForm.valid),e.xp6(1),e.Oqu(e.lcZ(2,2,"save"))}}function _(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().edit()}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.form.valid||!t.contactForm.valid),e.xp6(1),e.Oqu(e.lcZ(2,2,"edit"))}}class b{constructor(s,t,i,a,o,p,f,g){this.toastr=s,this.spinner=t,this.location=i,this.dialog=a,this.unionistService=o,this.translate=p,this.membershipService=f,this.store=g,this.tempStatus=!0,this.form=new x.cw({}),this.contactForm=new x.cw({}),this.countryList=[],this.model={udpnPeerType:1,chainMemberPhone:"",chainMemberLicense:""},this.options={},this.contactFields=[{fieldGroupClassName:"flex justify-between",wrappers:["panel"],templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.contactName")},fieldGroup:[{className:"w-1/3",type:"cInput",key:"chainMemberContact",templateOptions:{required:!0,maxLength:50},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.contactName"),"templateOptions.placeholder":this.translate.stream("membership.public.contactName")},validators:{chainMemberContact:{expression:c=>/^[A-Za-z0-9]+$/.test(c.value),message:this.translate.stream("membership.add.nameError")}}},{className:"col-6 w-full",type:"Input",key:"chainMemberPhone",templateOptions:{maxLength:20},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.mobileNumber"),"templateOptions.placeholder":this.translate.stream("membership.public.mobileNumber")},validators:{chainMemberPhone:{expression:c=>/^[0-9]*$/.test(c.value),message:this.translate.stream("membership.add.telError")}}}]},{fieldGroupClassName:"flex justify-between",wrappers:["panel"],templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.email")},fieldGroup:[{className:"w-full",type:"cInput",key:"nodeEmail",templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.email"),"templateOptions.placeholder":this.translate.stream("membership.public.email")},validators:{nodeEmail:{expression:c=>/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(c.value),message:this.translate.stream("membership.add.emailError")}}}]},{key:"chainMemberAddr",wrappers:["panel"],type:"cInput",templateOptions:{required:!0,maxLength:200},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.detailedAddress"),"templateOptions.placeholder":this.translate.stream("membership.public.detailedAddress")},validators:{chainMemberAddr:{expression:c=>/^[A-Za-z0-9]+$/.test(c.value),message:this.translate.stream("membership.add.nameError")}}},{fieldGroupClassName:"flex formlyTextarea",wrappers:["panel"],templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.businessLicense")},fieldGroup:[{type:"upload",templateOptions:{required:""===this.model.chainMemberLicense}}]},{fieldGroupClassName:"flex formlyTextarea",wrappers:["panel"],templateOptions:{height:"100px"},fieldGroup:[{key:"chainMemberLicense",type:"cimage",className:"w-full formlyTextareaKey",templateOptions:{required:!0},expressionProperties:{"templateOptions.labels":this.translate.stream("membership.public.businessLicense"),"templateOptions.placeholder":this.translate.stream("membership.public.businessLicense")}}]}],this.nodeFields=[{fieldGroupClassName:"flex justify-between",wrappers:["panel"],templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.nodeName")},fieldGroup:[{className:"col-6",type:"cInput",key:"udpnPeerName",templateOptions:{required:!0,maxLength:20},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.nodeName"),"templateOptions.placeholder":this.translate.stream("membership.public.nodeName")},validators:{nodeName:{expression:c=>/^(\\$|[a-zA-Z_])[a-zA-Z0-9]{1,50}$/.test(c.value),message:this.translate.stream("membership.add.nodeName")}}},{className:"col-6",type:"keyValue",key:"udpnPeerNo",templateOptions:{value:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.nodeCode")}}]},{fieldGroupClassName:"flex justify-between",wrappers:["panel"],templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.nodeType")},fieldGroup:[{key:"udpnPeerType",type:"select",className:"col-6",defaultValue:1,templateOptions:{change:()=>{this.getCode()},options:[{value:1,label:"BN"},{value:2,label:"TN"},{value:3,label:"TAR"}],compareWith:this.tempStatus?"":this.compareIdObjects},expressionProperties:{"templateOptions.labels":this.translate.stream("membership.public.nodeType"),"templateOptions.placeholder":this.translate.stream("membership.public.nodeType"),"templateOptions.disabled":()=>!1===this.tempStatus}}]},{fieldGroupClassName:"flex justify-between",wrappers:["panel"],templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.country")},fieldGroup:[{key:"country",type:"select",className:"w-full",defaultValue:1,templateOptions:{compareWith:this.tempStatus?"":this.compareIdObjects},expressionProperties:{"templateOptions.labels":this.translate.stream("membership.public.country"),"templateOptions.placeholder":this.translate.stream("membership.public.country"),"templateOptions.options":()=>this.countryList}}]},{key:"udpnPeerTitle",wrappers:["panel"],type:"cInput",templateOptions:{required:!0,maxLength:255},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.introduction"),"templateOptions.placeholder":this.translate.stream("membership.public.introduction")}},{fieldGroupClassName:"flex formlyTextarea",wrappers:["panel"],templateOptions:{required:!0,height:"100px"},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.description")},fieldGroup:[{key:"udpnPeerDesc",type:"textarea",className:"w-full",templateOptions:{required:!0,maxLength:500},expressionProperties:{"templateOptions.labels":this.translate.stream("membership.public.description"),"templateOptions.placeholder":this.translate.stream("membership.public.description")}}]},{fieldGroupClassName:"flex formlyTextarea",wrappers:["panel"],templateOptions:{required:!0},expressionProperties:{"templateOptions.label":this.translate.stream("membership.public.didDocument")},fieldGroup:[{type:"cbutton",key:"button"}]},{fieldGroupClassName:"flex formlyTextarea",wrappers:["panel"],templateOptions:{height:"380px"},fieldGroup:[{key:"udpnDidDocument",type:"textarea",className:"w-full formlyTextareaKey",templateOptions:{required:!0,readonly:!0},expressionProperties:{"templateOptions.labels":this.translate.stream("membership.public.didDocument"),"templateOptions.placeholder":this.translate.stream("membership.public.didDocument")}}]}]}ngOnInit(){this.getCountry(),this.paramsSubscription=this.params$.subscribe(s=>{"{}"!==JSON.stringify(s.param)&&(this.tempStatus=!1,this.infoData(s.param.nodeCode))})}compareIdObjects(s,t){return!(!t&&!s||t&&s.id!==t.id)}getCountry(){this.spinner.show(),this.countrySubscription=this.membershipService.getCountry({}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(s=>{this.countryList=s.data;const t=[];this.countryList.map((i,a)=>{t.push({value:Number(i.countryId),label:i.enName})}),this.countryList=t})}submit(){this.spinner.show(),this.getSubscription=this.unionistService.getLicense(this.model.chainMemberLicense).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(s=>{this.setSubscription=this.unionistService.setLicense({hash:s.data}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(t=>{this.memberLicense=s.data,this.addSubscription=this.membershipService.add({udpnDidDocument:this.model.udpnDidDocument,udpnPeerNo:this.model.udpnPeerNo,udpnPeerName:this.model.udpnPeerName,udpnPeerType:this.model.udpnPeerType,udpnPeerTitle:this.model.udpnPeerTitle,udpnPeerDesc:this.model.udpnPeerDesc,nodeEmail:this.model.nodeEmail,chainMemberAddr:this.model.chainMemberAddr,chainMemberContact:this.model.chainMemberContact,chainMemberLicense:this.memberLicense,country:this.model.country,chainMemberPhone:this.model.chainMemberPhone,chainMemberUrl:"https://127.0.0.1:8080"}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(i=>{if(0===i.code)return this.dialog.open(h.h,{panelClass:"dialog-container-custom",data:{title:"Success",body:"Node added successfully!"}}).afterClosed().subscribe(o=>{o&&this.location.back()}),void(this.model.chainMemberLicense="")})})})}infoData(s){this.spinner.show(),this.infoSubscription=this.membershipService.info({udpnDid:s}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(t=>{this.model.createDate=t.data.createDate,this.model.state=t.data.state,this.model.udpnDid=t.data.udpnDid,this.model.updateDate=t.data.updateDate,this.model.chainMemberUrl=t.data.chainMemberUrl,this.model.countryId=this.form.get("country"),this.model.udpnPeerType=this.form.get("udpnPeerType").value,this.model.udpnDidDocument=this.form.get("udpnDidDocument").value,this.model.chainMemberLicense=this.memberLicense,this.form.get("udpnPeerName").setValue(t.data.udpnPeerName),this.form.get("udpnPeerType").setValue(t.data.udpnPeerType),this.form.get("udpnPeerNo").setValue(t.data.udpnPeerNo),this.form.get("udpnPeerTitle").setValue(t.data.udpnPeerTitle),this.form.get("udpnPeerDesc").setValue(t.data.udpnPeerDesc),this.form.get("udpnDidDocument").setValue(t.data.memberNodeDidDoc),this.form.get("country").setValue(t.data.countryId),this.contactForm.get("nodeEmail").setValue(t.data.nodeEmail),this.contactForm.get("chainMemberAddr").setValue(t.data.chainMemberAddr),this.contactForm.get("chainMemberPhone").setValue(t.data.chainMemberPhone),this.contactForm.get("chainMemberContact").setValue(t.data.chainMemberContact),this.setSubscription=this.unionistService.setLicense({hash:t.data.memberLicense}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(i=>{this.contactForm.get("chainMemberLicense").setValue("data:image/jpg;base64,"+i.data),this.orignalMemberLicense=t.data.memberLicense})})}edit(){this.spinner.show(),this.model.chainMemberLicense===this.contactForm.get("chainMemberLicense").value?(this.model.chainMemberLicense=this.orignalMemberLicense,this.editSubscription=this.membershipService.edit(this.model).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(s=>{0!==s.code||this.dialog.open(h.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Edit successfully!"}}).afterClosed().subscribe(i=>{i&&this.location.back()})})):this.getSubscription=this.unionistService.getLicense(this.model.chainMemberLicense).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(s=>{this.setSubscription=this.unionistService.setLicense({hash:s.data}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(t=>{this.contactForm.get("chainMemberLicense").setValue("data:image/jpg;base64,"+t.data),this.model.chainMemberLicense=s.data,this.editSubscription=this.membershipService.edit(this.model).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(i=>{0!==i.code||this.dialog.open(h.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Edit successfully!"}}).afterClosed().subscribe(o=>{o&&this.location.back()})})})})}getCode(){this.spinner.show(),this.codeSubscription=this.membershipService.getNodeCode({nodeType:this.form.get("udpnPeerType").value}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(s=>{this.model.udpnPeerNo=s.data.udpnNodeCodeValue})}ngOnDestroy(){var s,t,i,a,o,p,f,g;this.store.dispatch(new A.A({})),null===(s=this.paramsSubscription)||void 0===s||s.unsubscribe(),null===(t=this.addSubscription)||void 0===t||t.unsubscribe(),null===(i=this.getSubscription)||void 0===i||i.unsubscribe(),null===(a=this.setSubscription)||void 0===a||a.unsubscribe(),null===(o=this.codeSubscription)||void 0===o||o.unsubscribe(),null===(p=this.editSubscription)||void 0===p||p.unsubscribe(),null===(f=this.infoSubscription)||void 0===f||f.unsubscribe(),null===(g=this.countrySubscription)||void 0===g||g.unsubscribe()}}b.\u0275fac=function(s){return new(s||b)(e.Y36(G._W),e.Y36(L.t2),e.Y36(T.Ye),e.Y36(I.uw),e.Y36(j.x),e.Y36(u.sK),e.Y36(P),e.Y36(C.yh))},b.\u0275cmp=e.Xpm({type:b,selectors:[["app-add"]],decls:18,vars:21,consts:[[3,"title"],[1,"font-sans","text-sm","whitespace-nowrap","font-bold","mb-8"],[3,"formGroup"],[1,"mb-8"],[3,"model","fields","options","form"],[1,"mt-8",3,"model","fields","options","form"],[1,"flex","justify-end"],["mat-stroked-button","","color","primary","type","button","routerLink","../"],["mat-raised-button","","color","primary","class","ml-4",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"ml-4",3,"disabled","click"]],template:function(s,t){1&s&&(e.TgZ(0,"app-udpn-card",0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"form",2),e.TgZ(5,"div",3),e._UZ(6,"formly-form",4),e.qZA(),e.TgZ(7,"div",1),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div"),e.TgZ(11,"formly-form",5),e.TgZ(12,"div",6),e.TgZ(13,"button",7),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.YNc(16,$,3,4,"button",8),e.YNc(17,_,3,4,"button",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&s&&(e.Q6J("title",t.tempStatus?"create":"edit"),e.xp6(2),e.Oqu(e.lcZ(3,15,"membership.list.nodeInfo")),e.xp6(2),e.Q6J("formGroup",t.form),e.xp6(2),e.Q6J("model",t.model)("fields",t.nodeFields)("options",t.options)("form",t.form),e.xp6(2),e.Oqu(e.lcZ(9,17,"membership.list.contactInfo")),e.xp6(3),e.Q6J("model",t.model)("fields",t.contactFields)("options",t.options)("form",t.contactForm),e.xp6(3),e.Oqu(e.lcZ(15,19,"back")),e.xp6(2),e.Q6J("ngIf",t.tempStatus),e.xp6(1),e.Q6J("ngIf",!t.tempStatus))},directives:[U.t,x._Y,x.JL,x.sg,S.T7,M.lW,y.rH,T.O5],pipes:[u.X$],styles:[""]}),(0,w.gn)([(0,C.Ph)(F.s.param)],b.prototype,"params$",void 0);var H=r(827);function B(n,s){if(1&n&&(e.ynx(0,9),e.TgZ(1,"tr",6),e.TgZ(2,"td",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"td",11),e._uU(6),e.qZA(),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(3),e.hij("",e.lcZ(4,2,"membership.public.repulseReason")," "),e.xp6(3),e.Oqu(t.infoDatas.nodeRepulseReason)}}function X(n,s){if(1&n&&(e.ynx(0,9),e.TgZ(1,"tr",6),e.TgZ(2,"td",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"td",11),e._uU(6),e.qZA(),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(3),e.hij("",e.lcZ(4,2,"membership.public.applyExitReason")," "),e.xp6(3),e.Oqu(t.infoDatas.applyExitReason)}}class v{constructor(s,t,i,a){this.spinner=s,this.translate=t,this.membershipService=i,this.store=a,this.nodeInfo=[],this.contactInfo=[]}ngOnInit(){this.paramsSubscription=this.params$.subscribe(s=>{"{}"!==JSON.stringify(s.param)&&this.infoData(s.param.nodeCode)})}infoData(s){this.spinner.show(),this.infoSubscription=this.membershipService.info({udpnDid:s}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(t=>{this.infoStatus=t.data.state,this.infoDatas=t.data,this.nodeInfo=[[{label:"membership.public.nodeName",value:t.data.udpnPeerName},{label:"membership.public.nodeCode",value:t.data.udpnPeerNo}],[{label:"membership.public.nodeType",value:t.data.udpnPeerType,type:"pip",pip:"nodeListType"},{label:"membership.public.creation",value:t.data.createDate,type:"pip",pip:"date"}],[{label:"membership.public.fromVN",value:t.data.fromVn},{label:"membership.public.status",value:t.data.state,type:"pip",pip:"nodeListStatus"}],[{label:"membership.public.country",value:t.data.country}],[{label:"membership.public.introduction",value:t.data.udpnPeerTitle,colspan:3,type:"text"}],[{label:"membership.public.description",value:t.data.udpnPeerDesc,colspan:3,type:"html"}],[{label:"membership.public.didDocument",value:t.data.memberNodeDidDoc,colspan:3,type:"did"}]],this.contactInfo=[[{label:"membership.public.contactName",value:t.data.chainMemberContact},{label:"membership.public.mobileNumber",value:t.data.chainMemberPhone}],[{label:"membership.public.email",value:t.data.nodeEmail}],[{label:"membership.public.detailedAddress",value:t.data.chainMemberAddr,colspan:3,type:"text"}],[{label:"membership.public.businessLicense",value:this.infoMemberLicense,type:"img"}]],this.setSubscription=this.membershipService.setLicense({hash:t.data.memberLicense}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(i=>{this.infoMemberLicense="data:image/jpg;base64,"+i.data,this.contactInfo[3]=[{label:"membership.public.businessLicense",value:this.infoMemberLicense,type:"img"}]})})}ngOnDestroy(){var s,t,i;this.store.dispatch(new A.A({})),null===(s=this.paramsSubscription)||void 0===s||s.unsubscribe(),null===(t=this.infoSubscription)||void 0===t||t.unsubscribe(),null===(i=this.setSubscription)||void 0===i||i.unsubscribe()}}v.\u0275fac=function(s){return new(s||v)(e.Y36(L.t2),e.Y36(u.sK),e.Y36(P),e.Y36(C.yh))},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-info"]],decls:17,vars:13,consts:[["title","detail"],[1,"font-sans","text-sm","whitespace-nowrap","font-bold","mb-4"],[3,"dataShow"],["head","",4,"ngIf"],[1,"font-sans","text-sm","whitespace-nowrap","font-bold","mt-8","mb-4"],["tail",""],[1,"h-16"],["colspan","4",1,"text-right"],["mat-stroked-button","","color","primary","type","button","routerLink","../"],["head",""],[1,"text-right","font-sans","text-sm","font-bold","pr-3","w-1/5"],["colspan","3"]],template:function(s,t){1&s&&(e.TgZ(0,"app-udpn-card",0),e.TgZ(1,"div",1),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"app-udpn-info",2),e.YNc(5,B,7,4,"ng-container",3),e.YNc(6,X,7,4,"ng-container",3),e.qZA(),e.TgZ(7,"div",4),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"app-udpn-info",2),e.ynx(11,5),e.TgZ(12,"tr",6),e.TgZ(13,"td",7),e.TgZ(14,"button",8),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA(),e.qZA(),e.BQk(),e.qZA(),e.qZA()),2&s&&(e.xp6(2),e.Oqu(e.lcZ(3,7,"membership.list.nodeInfo")),e.xp6(2),e.Q6J("dataShow",t.nodeInfo),e.xp6(1),e.Q6J("ngIf",2010===t.infoStatus),e.xp6(1),e.Q6J("ngIf",4===t.infoStatus||5===t.infoStatus),e.xp6(2),e.Oqu(e.lcZ(9,9,"membership.list.contactInfo")),e.xp6(2),e.Q6J("dataShow",t.contactInfo),e.xp6(5),e.Oqu(e.lcZ(16,11,"back")))},directives:[U.t,H.m,T.O5,M.lW,y.rH],pipes:[u.X$],styles:[""]}),(0,w.gn)([(0,C.Ph)(F.s.param)],v.prototype,"params$",void 0);var N=r(9247),Z=r(5001),K=r(5824),W=r(6852),R=r(7464),O=r(1451),q=r(5245);function ee(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",3),e.TgZ(1,"mat-icon"),e._uU(2,"more_vert"),e.qZA(),e.qZA(),e.TgZ(3,"mat-menu",null,4),e.TgZ(5,"button",5),e.NdJ("click",function(){const o=e.CHM(t).data;return e.oxw().onSubmit(o.nodeCode)}),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"button",5),e.NdJ("click",function(){const o=e.CHM(t).data,p=e.oxw();return p.onJump(p.app_path_edit,o.nodeCode,o.nodeName)}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"button",5),e.NdJ("click",function(){const o=e.CHM(t).data;return e.oxw().onApplyExit(o.nodeCode)}),e._uU(12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"button",5),e.NdJ("click",function(){const o=e.CHM(t).data;return e.oxw().onExit(o.nodeCode)}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"button",6),e.NdJ("click",function(){const o=e.CHM(t).data,p=e.oxw();return p.onJump(p.app_path_info,o.nodeCode,o.nodeName)}),e._uU(18),e.ALo(19,"translate"),e.qZA(),e.TgZ(20,"button",5),e.NdJ("click",function(){const o=e.CHM(t).data;return e.oxw().onDelete(o.nodeCode)}),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"button",5),e.NdJ("click",function(){const o=e.CHM(t).data,p=e.oxw();return p.onProposal(p.app_path_proposal,o.nodeCode)}),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.qZA()}if(2&n){const t=s.data,i=e.MAs(4);e.Q6J("matMenuTriggerFor",i),e.xp6(5),e.Q6J("disabled",1!==t.status),e.xp6(1),e.Oqu(e.lcZ(7,14,"submit")),e.xp6(2),e.Q6J("disabled",1!==t.status),e.xp6(1),e.Oqu(e.lcZ(10,16,"edit")),e.xp6(2),e.Q6J("disabled",3!==t.status||t.nodeIsApplyExited),e.xp6(1),e.Oqu(e.lcZ(13,18,"applyForExit")),e.xp6(2),e.Q6J("disabled",4!==t.status||t.nodeIsExited),e.xp6(1),e.Oqu(e.lcZ(16,20,"exit")),e.xp6(3),e.Oqu(e.lcZ(19,22,"detail")),e.xp6(2),e.Q6J("disabled",1!==t.status),e.xp6(1),e.Oqu(e.lcZ(22,24,"delete")),e.xp6(2),e.Q6J("disabled",1===t.status),e.xp6(1),e.Oqu(e.lcZ(25,26,"proposalHistory"))}}const te=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(()=>{class n{constructor(t,i,a,o,p,f,g){this.membershipService=t,this.dialog=i,this.spinner=a,this.translateService=o,this.router=p,this.sharedService=f,this.store=g,this.app_title="membership.list.title",this.app_create="membership.list.create",this.app_title_fiter="membership.list.fiter",this.app_path_proposal=(new N.w).proposalNetworkList,this.app_path_add=(new N.w).membershipAdd,this.app_path_edit=(new N.w).membershipEdit,this.app_path_info=(new N.w).membershipInfo,this.snapFilter=this.sharedService.getSnapFilter||{},this.pagedata=[{tag:"membership.public.nodeName",colunm:"nodeName",colunmData:"nodeName"},{tag:"membership.public.nodeCode",colunm:"nodeCode",colunmData:"nodeCode"},{tag:"membership.public.introduction",colunm:"nodeTitle",colunmData:"nodeTitle"},{tag:"membership.public.nodeType",colunm:"nodeType",colunmData:"nodeType",pip:"nodeListType"},{tag:"membership.public.creation",colunm:"createDate",colunmData:"createDate",pip:"date"},{tag:"membership.public.fromVN",colunm:"formVn",colunmData:"formVn"},{tag:"membership.public.status",colunm:"status",colunmData:"status",pip:"nodeListStatus"},{tag:"membership.list.action",colunm:"Action"}],this.dataFilter=[{name:"nodeName",tag:"membership.public.nodeName",type:"input",maxLen:24},{name:"nodeCode",tag:"membership.public.nodeCode",type:"input",maxLen:24},{name:"nodeType",tag:"membership.public.nodeType",type:"select",option:[{label:"ALL",val:""},{label:"BN",val:1},{label:"TN",val:2},{label:"TAR",val:3}]},{name:"createTime",tag:"membership.public.creation",type:"rangDate",startName:"startDate",endName:"endDate"},{name:"status",tag:"membership.public.nodeStatus",type:"select",option:[{label:"status.all",val:""},{label:"status.init",val:1},{label:"status.submitted",val:2},{label:"status.active",val:3},{label:"status.suspend",val:4},{label:"status.retired",val:5},{label:"status.rejected",val:6}]}]}ngOnInit(){this.loadService(this.snapFilter)}loadService(t){this.subscription=this.membershipService.list(t).subscribe(i=>{this.dataSource=i.data,this.total=i.resultPageInfo.total})}fetchAll(t){if(t.hasOwnProperty("type")&&"search"===t.type)return t.data.inPage={pageSize:10,pageNum:1},this.snapFilter=Object.assign(Object.assign({},this.snapFilter),t.data),void this.loadService(this.snapFilter);this.snapFilter=Object.assign(Object.assign({},this.snapFilter),t),this.loadService(this.snapFilter)}init(){this.snapFilter={},this.loadService(this.snapFilter)}onSubmit(t){this.dialog.open(Z.$,{panelClass:"dialog-container-custom",data:{title:"Submit",body:"Are you sure you want to submit this node ?"}}).afterClosed().subscribe(a=>{a&&(this.spinner.show(),this.submitSubscription=this.membershipService.submit({udpnNodeCode:t}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(o=>{0!==o.code||this.dialog.open(h.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Submit successfully!"}}).afterClosed().subscribe(()=>{this.init()})}))})}onApplyExit(t){this.dialog.open(K.A,{panelClass:"dialog-container-custom",data:{title:"Apply For Exit"}}).afterClosed().subscribe(a=>{a&&(this.spinner.show(),this.applyExitSubscription=this.membershipService.applyExit({nodeCode:t,applyReason:a}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(o=>{0!==o.code||this.dialog.open(h.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Apply For Exit successfully!"}}).afterClosed().subscribe(()=>{this.init()})}))})}onExit(t){this.dialog.open(Z.$,{panelClass:"dialog-container-custom",data:{title:"Exit",body:"Are you sure you want to exit this node ?"}}).afterClosed().subscribe(a=>{a&&(this.spinner.show(),this.exitSubscription=this.membershipService.exit({nodeCode:t}).pipe((0,l.x)(()=>this.spinner.hide())).subscribe(o=>{0!==o.code||this.dialog.open(h.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Submit successfully!"}}).afterClosed().subscribe(()=>{this.init()})}))})}onDelete(t){this.dialog.open(Z.$,{panelClass:"dialog-container-custom",data:{title:"Delete",body:"Are you sure you want to delete this node?"}}).afterClosed().subscribe(a=>{a&&(this.deleteSubscription=this.membershipService.delete({udpnDid:t}).subscribe(o=>{0!==o.code||this.dialog.open(h.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Delete successfully!"}}).afterClosed().subscribe(()=>{this.init()})}))})}onProposal(t,i){this.sharedService.setSnapFilter={nodeCode:i},this.router.navigate([t])}onJump(t,i,a){this.store.dispatch(new A.A({nodeCode:i,nodeName:a})).subscribe(o=>{this.router.navigate([t])})}ngOnDestroy(){var t,i,a,o,p;null===(t=this.subscription)||void 0===t||t.unsubscribe(),null===(i=this.submitSubscription)||void 0===i||i.unsubscribe(),null===(a=this.deleteSubscription)||void 0===a||a.unsubscribe(),null===(o=this.applyExitSubscription)||void 0===o||o.unsubscribe(),null===(p=this.exitSubscription)||void 0===p||p.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(P),e.Y36(I.uw),e.Y36(L.t2),e.Y36(u.sK),e.Y36(y.F0),e.Y36(W.F),e.Y36(C.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-list"]],decls:6,vars:10,consts:[[3,"title_fiter","title","dataSource","pagedata","dataFilter","t","toParentOk","toParentCal"],["table-top",""],["mat-flat-button","","color","primary",3,"routerLink"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",1,"c-hover",3,"disabled","click"],["mat-menu-item","",1,"c-hover",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"app-udpn-list",0),e.NdJ("toParentOk",function(o){return i.fetchAll(o)})("toParentCal",function(){return i.init()}),e.ynx(1,1),e.TgZ(2,"button",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.BQk(),e.YNc(5,ee,26,28,"ng-template"),e.qZA()),2&t&&(e.Q6J("title_fiter",i.app_title_fiter)("title",i.app_title)("dataSource",i.dataSource)("pagedata",i.pagedata)("dataFilter",i.dataFilter)("t",i.total),e.xp6(2),e.Q6J("routerLink",i.app_path_add),e.xp6(1),e.Oqu(e.lcZ(4,8,i.app_create)))},directives:[R.p,M.lW,y.rH,O.p6,q.Hw,O.VK,O.OP],pipes:[u.X$],styles:[""]}),n})()},{path:"info",component:v},{path:"add",component:b},{path:"edit",component:b}];let ie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[y.Bz.forChild(te)],y.Bz]}),n})();var se=r(2201),ae=r(8530),ne=r(6867),oe=r(1081),re=r(1694);let pe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[{provide:k.o2,useValue:{appearance:"outline"}},{provide:S.l7,multi:!0,useFactory:Q.R,deps:[u.sK]}],imports:[[E.m,T.ez,J.o,ie,S.X0.forRoot({types:[{name:"cInput",component:V.N},{name:"keyValue",component:ae.n},{name:"cbutton",component:se.k},{name:"cimage",component:ne.j},{name:"Input",component:oe.h},{name:"upload",component:re.u}],wrappers:[{name:"panel",component:Y.X}]})]]}),n})()}}]);