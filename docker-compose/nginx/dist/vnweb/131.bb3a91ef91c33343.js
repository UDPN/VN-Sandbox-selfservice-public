"use strict";(self.webpackChunkudpn_tem2=self.webpackChunkudpn_tem2||[]).push([[131],{1131:(K,T,s)=>{s.r(T),s.d(T,{ProposalServiceModule:()=>X});var m=s(9808),d=s(5089),A=s(655),v=s(6661),b=s(8746),Z=s(2192),D=s(4842),e=s(5e3),S=s(72),g=s(4004);let h=(()=>{class i{}return i.list="v1/udpn/control/vote/proposal/manage/service/fee/searches",i.info="v1/udpn/control/vote/proposal/manage/service/fee/detail",i.vote="v1/udpn/control/proposal/vote",i.submit="v1/udpn/control/vote/proposal/manage/service/fee/submit",i})();var J=s(520);let C=(()=>{class i{constructor(t){this.http=t}list(t){return this.http.post(h.list,{proposalCode:t.proposalCode||"",feeName:t.feeName||"",feeCode:t.feeCode||"",submitStartDate:t.startDate||"",submitEndDate:t.endDate||"",voteResult:t.voteResult,currentVnCode:t.currentVnCode||"",feeModel:t.chainFeeModel||"",inPage:t.inPage||{pageSize:10,pageIndex:1}}).pipe((0,g.U)(n=>n))}info(t){return this.http.post(h.info,{voteId:t.voteId||""}).pipe((0,g.U)(n=>n))}vote(t){return this.http.post(h.vote,{proposalCode:t.proposalCode||"",myselfResult:t.myselfResult||"",myselfRemark:t.myselfRemark||""}).pipe((0,g.U)(n=>n))}submit(t){return this.http.post(h.submit,{voteId:t.voteId||""}).pipe((0,g.U)(n=>n))}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(J.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var x=s(2214),R=s(827),L=s(8855),q=s(5144),I=s(7423),y=s(1062);function V(i,a){if(1&i&&(e.ynx(0,2),e.TgZ(1,"tr",3),e.TgZ(2,"td",4),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"td",5),e._UZ(6,"app-udpn-table",11),e.qZA(),e.qZA(),e.BQk()),2&i){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"service.public.information")),e.xp6(3),e.Q6J("dataSource",t.dataSource)("pagedata",t.pagedata)}}class p{constructor(a,t,o){this.spinner=a,this.proposalServiceService=t,this.store=o,this.dataSource=[],this.dataSources=[],this.dataShow=[],this.serviceFeeList={},this.serviceFeeTabs=["Changed","All"],this.pagedata=[{tag:"votingInformation.VotingResult",colunm:"voteResult",colunmData:"voteResult",pip:"voteResult"},{tag:"votingInformation.yesVote",colunm:"voteAgree",colunmData:"voteAgree"},{tag:"votingInformation.negtiveVote",colunm:"voteDisagree",colunmData:"voteDisagree"},{tag:"votingInformation.notVoted",colunm:"voteNot",colunmData:"voteNot"}],this.pagedatas=[{tag:"service.serviceFeeDetails.currencyType",colunm:"currencyType",colunmData:"currencyType"},{tag:"service.serviceFeeDetails.originalChargingModel",colunm:"originalChainFeeModel",colunmData:"originalChainFeeModel",pip:"serviceFeeModel"},{tag:"service.serviceFeeDetails.originalServiceFee",colunm:"originalServiceFee",colunmData:"originalServiceFee"},{tag:"service.serviceFeeDetails.chargingModel",colunm:"chainFeeModel",colunmData:"chainFeeModel",pip:"serviceFeeModel"},{tag:"service.serviceFeeDetails.serviceFee",colunm:"serviceFee",colunmData:"serviceFee"}]}ngOnInit(){this.paramsSubscription=this.params$.subscribe(a=>{"{}"!==JSON.stringify(a.param)&&this.infoData(a.param.voteId)})}change(a){this.dataSources=1===a?this.serviceFeeList.allDetails:this.serviceFeeList.changeDetails}infoData(a){this.spinner.show(),this.infoSubscription=this.proposalServiceService.info({voteId:a}).pipe((0,b.x)(()=>this.spinner.hide())).subscribe(t=>{this.voteResult=t.data.voteResult,this.serviceFeeList=t.data,this.dataSources=this.serviceFeeList.changeDetails,this.dataSource=[{voteResult:t.data.voteResult,voteAgree:t.data.voteAgree,voteNot:t.data.voteNot,voteDisagree:t.data.voteDisagree}],this.dataShow=[[{label:"service.public.proposalCode",value:t.data.proposalCode},{label:"service.public.serviceFeeTitle",value:t.data.feeName}],[{label:"service.public.serviceFeeCode",value:t.data.feeCode},{label:"service.public.fromVN",value:t.data.fromVnName}],[{label:"service.public.submission",value:t.data.submitDate,type:"pip",pip:"date"},{label:"service.public.status",value:t.data.voteResult,colspan:3,type:"pip",pip:"voteResult"}],[{label:"service.public.myVote",value:t.data.myselfResult,colspan:3,type:"pip",pip:"voteStatus"}],[{label:"service.public.votingComments",value:t.data.myselfRemark,colspan:3,type:"html"}]]})}ngOnDestroy(){var a,t;this.store.dispatch(new Z.A({})),null===(a=this.paramsSubscription)||void 0===a||a.unsubscribe(),null===(t=this.infoSubscription)||void 0===t||t.unsubscribe()}}p.\u0275fac=function(a){return new(a||p)(e.Y36(S.t2),e.Y36(C),e.Y36(v.yh))},p.\u0275cmp=e.Xpm({type:p,selectors:[["app-info"]],decls:17,vars:11,consts:[["title","detail"],[3,"dataShow"],["tail",""],[1,"h-36"],[1,"text-right","font-sans","text-sm","font-bold","pr-3","w-1/5"],["colspan","3"],[3,"dataSource","pagedata","changeTabs","selectedIndexChange"],["tail","",4,"ngIf"],[1,"h-16"],["colspan","4",1,"text-right"],["mat-stroked-button","","color","primary","type","button","routerLink","../"],[3,"dataSource","pagedata"]],template:function(a,t){1&a&&(e.TgZ(0,"app-udpn-card",0),e.TgZ(1,"app-udpn-info",1),e.ynx(2,2),e.TgZ(3,"tr",3),e.TgZ(4,"td",4),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"td",5),e.TgZ(8,"div"),e.TgZ(9,"app-udpn-mat-table",6),e.NdJ("selectedIndexChange",function(n){return t.change(n)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk(),e.YNc(10,V,7,5,"ng-container",7),e.ynx(11,2),e.TgZ(12,"tr",8),e.TgZ(13,"td",9),e.TgZ(14,"button",10),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA(),e.qZA(),e.BQk(),e.qZA(),e.qZA()),2&a&&(e.xp6(1),e.Q6J("dataShow",t.dataShow),e.xp6(4),e.Oqu(e.lcZ(6,7,"service.public.serviceFee")),e.xp6(4),e.Q6J("dataSource",t.dataSources)("pagedata",t.pagedatas)("changeTabs",t.serviceFeeTabs),e.xp6(1),e.Q6J("ngIf",1===t.voteResult||2===t.voteResult),e.xp6(5),e.Oqu(e.lcZ(16,9,"back")))},directives:[x.t,R.m,L.O,m.O5,q.$,I.lW,d.rH],pipes:[y.X$],styles:[""]}),(0,A.gn)([(0,v.Ph)(D.s.param)],p.prototype,"params$",void 0);var N=s(9247),F=s(1422),M=s(8966),P=s(6852),U=s(7464);const f=function(i){return{hidden:i}};function Q(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"div",2),e.TgZ(2,"a",3),e.NdJ("click",function(){const r=e.CHM(t).data,l=e.oxw();return l.onJump(l.app_path_vote,r.voteId,r.proposalCode)}),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.qZA(),e.TgZ(5,"span",4),e._uU(6,"|"),e.qZA(),e.TgZ(7,"div",2),e.TgZ(8,"a",5),e.NdJ("click",function(){const r=e.CHM(t).data;return e.oxw().onSubmit(r.voteId)}),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.qZA(),e.TgZ(11,"span",6),e._uU(12,"|"),e.qZA(),e.TgZ(13,"div",2),e.TgZ(14,"a",7),e.NdJ("click",function(){const r=e.CHM(t).data,l=e.oxw();return l.onJump(l.app_path_info,r.voteId,r.proposalCode)}),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.qZA(),e.qZA()}if(2&i){const t=a.data;e.xp6(2),e.Q6J("ngClass",e.VKq(13,f,0!==t.voteResult||null!==t.myselfResult)),e.xp6(1),e.Oqu(e.lcZ(4,7,"vote")),e.xp6(2),e.Q6J("ngClass",e.VKq(15,f,0!==t.voteResult||null!==t.myselfResult)),e.xp6(3),e.Q6J("ngClass",e.VKq(17,f,2e3!==t.voteResult)),e.xp6(1),e.Oqu(e.lcZ(10,9,"submit")),e.xp6(2),e.Q6J("ngClass",e.VKq(19,f,2e3!==t.voteResult)),e.xp6(4),e.Oqu(e.lcZ(16,11,"detail"))}}let Y=(()=>{class i{constructor(t,o,n,r,l,H){this.serviceFeeService=t,this.spinner=o,this.dialog=n,this.router=r,this.sharedService=l,this.store=H,this.app_title="service.list.title",this.app_title_fiter="service.list.fiter",this.app_path_info=(new N.w).proposalServiceInfo,this.app_path_vote=(new N.w).proposalServiceVote,this.snapFilter=this.sharedService.getSnapFilter||{},this.pagedata=[{tag:"service.public.proposalCode",colunm:"proposalCode",colunmData:"proposalCode"},{tag:"service.public.serviceFeeTitle",colunm:"feeName",colunmData:"feeName"},{tag:"service.public.serviceFeeCode",colunm:"feeCode",colunmData:"feeCode"},{tag:"service.public.submission",colunm:"submitDate",colunmData:"submitDate",pip:"date"},{tag:"service.public.fromVN",colunm:"fromVnName",colunmData:"fromVnName"},{tag:"service.public.status",colunm:"voteResult",colunmData:"voteResult",pip:"voteResult"},{tag:"service.public.myVote",colunm:"myselfResult",colunmData:"myselfResult",pip:"voteStatus"},{tag:"service.list.action",colunm:"Action"}],this.dataFilter=[{name:"proposalCode",tag:"service.public.proposalCode",type:"input",maxLen:24},{name:"feeName",tag:"service.public.serviceFeeTitle",type:"input",maxLen:24},{name:"feeCode",tag:"service.public.serviceFeeCode",type:"input",maxLen:24},{name:"chainFeeModel",tag:"service.public.chargingModel",type:"select",option:[{label:"chargingModel.all",val:""},{label:"chargingModel.fixedFee",val:1},{label:"chargingModel.ratio",val:2}]},{name:"submitDate",tag:"service.public.submission",type:"rangDate",startName:"startDate",endName:"endDate"},{name:"voteResult",tag:"service.public.status",type:"select",option:[{label:"proposalStatus.all",val:""},{label:"proposalStatus.pending",val:0},{label:"proposalStatus.approved",val:1},{label:"proposalStatus.rejected",val:2}]}]}ngOnInit(){this.loadService(this.snapFilter)}loadService(t){this.subscription=this.serviceFeeService.list(t).subscribe(o=>{this.dataSource=o.data,this.total=o.resultPageInfo.total})}fetchAll(t){if(t.hasOwnProperty("type")&&"search"===t.type)return t.data.inPage={pageSize:10,pageNum:1},this.snapFilter=Object.assign(Object.assign({},this.snapFilter),t.data),void this.loadService(this.snapFilter);this.snapFilter=Object.assign(Object.assign({},this.snapFilter),t),this.loadService(this.snapFilter)}init(){this.snapFilter={},this.loadService(this.snapFilter)}onSubmit(t){this.dialog.open(F.h,{panelClass:"dialog-container-custom",data:{title:"Prompt",body:"Are you sure you want to submit this proposal?"}}).afterClosed().subscribe(n=>{n&&(this.submitSubscription=this.serviceFeeService.submit({voteId:t}).subscribe(r=>{0!==r.code||this.dialog.open(F.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Submit successfully!"}}).afterClosed().subscribe(()=>{this.init()})}))})}onJump(t,o,n){this.store.dispatch(new Z.A({voteId:o,proposalCode:n})).subscribe(r=>{this.router.navigate([t])})}ngOnDestroy(){var t,o;null===(t=this.subscription)||void 0===t||t.unsubscribe(),null===(o=this.submitSubscription)||void 0===o||o.unsubscribe(),this.sharedService.setSnapFilter={}}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C),e.Y36(S.t2),e.Y36(M.uw),e.Y36(d.F0),e.Y36(P.F),e.Y36(v.yh))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-list"]],decls:2,vars:6,consts:[[3,"title_fiter","title","dataSource","pagedata","dataFilter","t","toParentOk","toParentCal"],[1,"flex"],[1,"c-btn"],[1,"text-blue-900","font-semibold",3,"ngClass","click"],[1,"",3,"ngClass"],[1,"text-yellow-500","font-semibold",3,"ngClass","click"],[1,"mr-4",3,"ngClass"],[1,"text-yellow-500","font-semibold",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"app-udpn-list",0),e.NdJ("toParentOk",function(r){return o.fetchAll(r)})("toParentCal",function(){return o.init()}),e.YNc(1,Q,17,21,"ng-template"),e.qZA()),2&t&&e.Q6J("title_fiter",o.app_title_fiter)("title",o.app_title)("dataSource",o.dataSource)("pagedata",o.pagedata)("dataFilter",o.dataFilter)("t",o.total)},directives:[U.p,m.mk],pipes:[y.X$],styles:[""]}),i})();var c=s(3075),O=s(9814),k=s(7322),w=s(8833);class u{constructor(a,t,o,n,r,l){this.spinner=a,this.formBuilder=t,this.dialog=o,this.lacation=n,this.proposalServiceService=r,this.store=l,this.dataSource=[],this.serviceFeeList={},this.serviceFeeTabs=["Changed","All"],this.dataShow=[],this.form=new c.cw({}),this.pagedata=[{tag:"service.serviceFeeDetails.currencyType",colunm:"currencyType",colunmData:"currencyType"},{tag:"service.serviceFeeDetails.originalChargingModel",colunm:"originalChainFeeModel",colunmData:"originalChainFeeModel",pip:"serviceFeeModel"},{tag:"service.serviceFeeDetails.originalServiceFee",colunm:"originalServiceFee",colunmData:"originalServiceFee"},{tag:"service.serviceFeeDetails.chargingModel",colunm:"chainFeeModel",colunmData:"chainFeeModel",pip:"serviceFeeModel"},{tag:"service.serviceFeeDetails.serviceFee",colunm:"serviceFee",colunmData:"serviceFee"}],this.initFormBuilder()}ngOnInit(){this.paramsSubscription=this.params$.subscribe(a=>{"{}"!==JSON.stringify(a.param)&&this.infoData(a.param.voteId)})}initFormBuilder(){this.form=this.formBuilder.group({myselfRemark:["",[c.kI.required]],myselfResult:["true",[c.kI.required]]})}infoData(a){this.spinner.show(),this.infoSubscription=this.proposalServiceService.info({voteId:a}).pipe((0,b.x)(()=>this.spinner.hide())).subscribe(t=>{this.serviceFeeList=t.data,this.dataSource=this.serviceFeeList.changeDetails,this.dataShow=[[{label:"service.public.proposalCode",value:t.data.proposalCode},{label:"service.public.serviceFeeTitle",value:t.data.feeName}],[{label:"service.public.serviceFeeCode",value:t.data.feeCode},{label:"service.public.fromVN",value:t.data.fromVnName}],[{label:"service.public.submission",value:t.data.submitDate,type:"pip",pip:"date"},{label:"service.public.status",value:t.data.voteResult,type:"pip",pip:"voteResult"}]]})}change(a){this.dataSource=1===a?this.serviceFeeList.allDetails:this.serviceFeeList.changeDetails}submit(){this.spinner.show(),this.voteSubscription=this.proposalServiceService.vote({myselfResult:this.form.get("myselfResult").value,proposalCode:this.serviceFeeList.proposalCode,myselfRemark:this.form.get("myselfRemark").value}).pipe((0,b.x)(()=>this.spinner.hide())).subscribe(a=>{0!==a.code||this.dialog.open(F.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"vote successfully!"}}).afterClosed().subscribe(o=>{o&&this.lacation.back()})})}ngOnDestroy(){var a,t,o;this.store.dispatch(new Z.A({})),null===(a=this.paramsSubscription)||void 0===a||a.unsubscribe(),null===(t=this.infoSubscription)||void 0===t||t.unsubscribe(),null===(o=this.voteSubscription)||void 0===o||o.unsubscribe()}}u.\u0275fac=function(a){return new(a||u)(e.Y36(S.t2),e.Y36(c.qu),e.Y36(M.uw),e.Y36(m.Ye),e.Y36(C),e.Y36(v.yh))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-vote"]],decls:44,vars:27,consts:[["title","vote"],[3,"formGroup"],[3,"dataShow"],["tail",""],[1,"h-36"],[1,"text-right","font-sans","text-sm","font-bold","pr-3","w-1/4"],["colspan","3"],[3,"dataSource","pagedata","changeTabs","selectedIndexChange"],[1,"h-20"],[1,"text-right","font-sans","text-sm","font-bold","pr-3","w-1/5"],[1,"text-red-600"],["formControlName","myselfResult"],["value","true","checked","true",1,"mr-8"],["value","false",1,"second"],["appearance","outline",1,"w-full"],["matInput","","placeholder","comments","formControlName","myselfRemark",1,"!ring-transparent","h-12"],[1,"h-16"],["colspan","4",1,"text-right"],["mat-stroked-button","","color","primary","type","button","routerLink","../"],["mat-raised-button","","color","primary",1,"ml-4",3,"disabled","click"]],template:function(a,t){1&a&&(e.TgZ(0,"app-udpn-card",0),e.TgZ(1,"form",1),e.TgZ(2,"app-udpn-info",2),e.ynx(3,3),e.TgZ(4,"tr",4),e.TgZ(5,"td",5),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"td",6),e.TgZ(9,"div"),e.TgZ(10,"app-udpn-mat-table",7),e.NdJ("selectedIndexChange",function(n){return t.change(n)}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk(),e.ynx(11,3),e.TgZ(12,"tr",8),e.TgZ(13,"td",9),e.TgZ(14,"span",10),e._uU(15,"*"),e.qZA(),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"td",6),e.TgZ(19,"mat-radio-group",11),e.TgZ(20,"mat-radio-button",12),e._uU(21),e.ALo(22,"translate"),e.qZA(),e.TgZ(23,"mat-radio-button",13),e._uU(24),e.ALo(25,"translate"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"tr"),e.TgZ(27,"td",9),e.TgZ(28,"span",10),e._uU(29,"*"),e.qZA(),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"td",6),e.ynx(33),e.TgZ(34,"mat-form-field",14),e._UZ(35,"textarea",15),e.qZA(),e.BQk(),e.qZA(),e.qZA(),e.TgZ(36,"tr",16),e.TgZ(37,"td",17),e.TgZ(38,"button",18),e._uU(39),e.ALo(40,"translate"),e.qZA(),e.TgZ(41,"button",19),e.NdJ("click",function(){return t.submit()}),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.qZA(),e.qZA(),e.BQk(),e.qZA(),e.qZA(),e.qZA()),2&a&&(e.xp6(1),e.Q6J("formGroup",t.form),e.xp6(1),e.Q6J("dataShow",t.dataShow),e.xp6(4),e.Oqu(e.lcZ(7,13,"service.public.serviceFee")),e.xp6(4),e.Q6J("dataSource",t.dataSource)("pagedata",t.pagedata)("changeTabs",t.serviceFeeTabs),e.xp6(6),e.Oqu(e.lcZ(17,15,"service.public.votingResult")),e.xp6(5),e.Oqu(e.lcZ(22,17,"agree")),e.xp6(3),e.Oqu(e.lcZ(25,19,"disagree")),e.xp6(6),e.Oqu(e.lcZ(31,21,"service.public.comments")),e.xp6(9),e.Oqu(e.lcZ(40,23,"back")),e.xp6(2),e.Q6J("disabled",!t.form.valid),e.xp6(1),e.Oqu(e.lcZ(43,25,"save")))},directives:[x.t,c._Y,c.JL,c.sg,R.m,L.O,O.VQ,c.JJ,c.u,O.U0,k.KE,w.Nt,c.Fj,I.lW,d.rH],pipes:[y.X$],styles:[""]}),(0,A.gn)([(0,v.Ph)(D.s.param)],u.prototype,"params$",void 0);const B=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:Y},{path:"info",component:p},{path:"vote",component:u}];let z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.Bz.forChild(B)],d.Bz]}),i})();var j=s(3767),$=s(8554);let X=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[m.ez,j.m,$.o,z]]}),i})()}}]);