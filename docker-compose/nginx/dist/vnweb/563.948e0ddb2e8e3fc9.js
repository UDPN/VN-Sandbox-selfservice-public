"use strict";(self.webpackChunkudpn_tem2=self.webpackChunkudpn_tem2||[]).push([[563],{4563:(X,S,s)=>{s.r(S),s.d(S,{ProposalTnNodeModule:()=>j});var b=s(9808),h=s(5089),N=s(655),v=s(6661),g=s(8746),y=s(2192),x=s(4842),t=s(5e3),T=s(72),u=s(4004);let c=(()=>{class a{}return a.list="v1/udpn/control/vote/proposal/manage/business/searches",a.currencytype="v1/udpn/member/common/search/splice/currency",a.info="v1/udpn/control/vote/proposal/manage/business/detail",a.vote="v1/udpn/control/proposal/vote",a.submit="v1/udpn/control/vote/proposal/manage/business/submit",a.platformTypeList="v1/udpn/control/vote/proposal/manage/business/all/platform/type/list",a.currencytypeList="v1/udpn/control/vote/proposal/manage/business/all/currency/type/list",a})();var P=s(520);let Z=(()=>{class a{constructor(e){this.http=e}list(e){return this.http.post(c.list,{inPage:e.inPage||{pageSize:10,pageNum:1},proposalCode:e.proposalCode||"",nodeName:e.nodeName||"",nodeCode:e.nodeCode||"",platformType:e.platformType||"",currencyType:e.currencyType||"",submitStartDate:e.startDate||"",submitEndDate:e.endDate||"",voteResult:e.voteResult}).pipe((0,u.U)(i=>i))}platformTypeList(){return this.http.post(c.platformTypeList,{}).pipe((0,u.U)(o=>o))}currencytypeList(){return this.http.post(c.currencytypeList,{}).pipe((0,u.U)(o=>o))}currencytype(){return this.http.post(c.currencytype,{}).pipe((0,u.U)(o=>o))}info(e){return this.http.post(c.info,{voteId:e.voteId||""}).pipe((0,u.U)(i=>i))}vote(e){return this.http.post(c.vote,{proposalCode:e.proposalCode||"",myselfResult:e.myselfResult||"",myselfRemark:e.myselfRemark||""}).pipe((0,u.U)(i=>i))}submit(e){return this.http.post(c.submit,{voteId:e.voteId||""}).pipe((0,u.U)(i=>i))}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(P.eN))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var F=s(2214),L=s(827),J=s(5144),R=s(7423),C=s(1062);function U(a,n){if(1&a&&(t.ynx(0,3),t.TgZ(1,"tr",7),t.TgZ(2,"td",8),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"td",9),t._UZ(6,"app-udpn-table",10),t.qZA(),t.qZA(),t.BQk()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,3,"tn-node.public.information")),t.xp6(3),t.Q6J("dataSource",e.dataSource)("pagedata",e.pagedata)}}class d{constructor(n,e,o){this.spinner=n,this.proposalTnNodeService=e,this.store=o,this.dataShow=[],this.pagedata=[{tag:"votingInformation.VotingResult",colunm:"voteResult",colunmData:"voteResult",pip:"voteResult"},{tag:"votingInformation.yesVote",colunm:"voteAgree",colunmData:"voteAgree"},{tag:"votingInformation.negtiveVote",colunm:"voteDisagree",colunmData:"voteDisagree"},{tag:"votingInformation.notVoted",colunm:"voteNot",colunmData:"voteNot"}]}ngOnInit(){this.paramsSubscription=this.params$.subscribe(n=>{"{}"!==JSON.stringify(n.param)&&this.infoData(n.param.voteId)})}infoData(n){this.spinner.show(),this.infoSubscription=this.proposalTnNodeService.info({voteId:n}).pipe((0,g.x)(()=>this.spinner.hide())).subscribe(e=>{this.dataSource=[{voteResult:e.data.voteResult,voteAgree:e.data.voteAgree,voteNot:e.data.voteNot,voteDisagree:e.data.voteDisagree}],this.dataShow=[[{label:"tn-node.public.proposalCode",value:e.data.proposalCode},{label:"tn-node.public.nodeName",value:e.data.nodeName}],[{label:"tn-node.public.nodeCode",value:e.data.nodeCode},{label:"tn-node.public.account",value:e.data.businessCapitalpool}],[{label:"tn-node.public.currencyType",value:e.data.currencyType},{label:"tn-node.public.precision",value:e.data.currencyPrecision}],[{label:"tn-node.public.chainFeeModel",value:1===e.data.chainFeeModel?"Fixed Fee":"Transaction Amount Ratio"},{label:"tn-node.public.serviceFee",value:1===e.data.chainFeeModel?e.data.chainFixFee:"At least:"+e.data.chainRatioFeeLeast+",At Most:"+e.data.chainRatioFeeMost+", Normal: "+e.data.chainRatioFee+"%"}],[{label:"tn-node.public.isKYC",value:e.data.businessKyc,type:"pip",pip:"isKyc"},{label:"tn-node.public.submission",value:e.data.submitDate,type:"pip",pip:"date"}],[{label:"tn-node.public.status",value:e.data.voteResult,type:"pip",pip:"voteResult"},{label:"tn-node.public.url",value:e.data.url}],[{label:"tn-node.public.myVote",value:e.data.myselfResult,type:"pip",pip:"voteStatus"}],[{label:"tn-node.public.votingComments",value:e.data.myselfRemark,colspan:3,type:"html"}]]})}ngOnDestroy(){var n,e;this.store.dispatch(new y.A({})),null===(n=this.paramsSubscription)||void 0===n||n.unsubscribe(),null===(e=this.infoSubscription)||void 0===e||e.unsubscribe()}}d.\u0275fac=function(n){return new(n||d)(t.Y36(T.t2),t.Y36(Z),t.Y36(v.yh))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-info"]],decls:9,vars:5,consts:[["title","detail"],[3,"dataShow"],["tail","",4,"ngIf"],["tail",""],[1,"h-16"],["colspan","4",1,"text-right"],["mat-stroked-button","","color","primary","type","button","routerLink","../"],[1,"h-36"],[1,"text-right","font-sans","text-sm","font-bold","pr-3","w-1/5"],["colspan","3"],[3,"dataSource","pagedata"]],template:function(n,e){1&n&&(t.TgZ(0,"app-udpn-card",0),t.TgZ(1,"app-udpn-info",1),t.YNc(2,U,7,5,"ng-container",2),t.ynx(3,3),t.TgZ(4,"tr",4),t.TgZ(5,"td",5),t.TgZ(6,"button",6),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.qZA(),t.qZA(),t.BQk(),t.qZA(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("dataShow",e.dataShow),t.xp6(1),t.Q6J("ngIf",1===e.voteResult||2===e.voteResult),t.xp6(5),t.Oqu(t.lcZ(8,3,"back")))},directives:[F.t,L.m,b.O5,J.$,R.lW,h.rH],pipes:[C.X$],styles:[""]}),(0,N.gn)([(0,v.Ph)(x.s.param)],d.prototype,"params$",void 0);var D=s(9247),A=s(1422),I=s(8966),Y=s(6852),M=s(7464);const f=function(a){return{hidden:a}};function V(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.TgZ(2,"a",3),t.NdJ("click",function(){const l=t.CHM(e).data,r=t.oxw();return r.onJump(r.app_path_vote,l.voteId,l.proposalCode)}),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.qZA(),t.TgZ(5,"span",4),t._uU(6,"|"),t.qZA(),t.TgZ(7,"div",2),t.TgZ(8,"a",5),t.NdJ("click",function(){const l=t.CHM(e).data;return t.oxw().onSubmit(l.voteId)}),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.qZA(),t.TgZ(11,"span",4),t._uU(12,"|"),t.qZA(),t.TgZ(13,"div",2),t.TgZ(14,"a",6),t.NdJ("click",function(){const l=t.CHM(e).data,r=t.oxw();return r.onJump(r.app_path_info,l.voteId,l.proposalCode)}),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=n.data;t.xp6(2),t.Q6J("ngClass",t.VKq(13,f,0!==e.voteResult||null!==e.myselfResult)),t.xp6(1),t.Oqu(t.lcZ(4,7,"vote")),t.xp6(2),t.Q6J("ngClass",t.VKq(15,f,0!==e.voteResult||null!==e.myselfResult)),t.xp6(3),t.Q6J("ngClass",t.VKq(17,f,2e3!==e.voteResult)),t.xp6(1),t.Oqu(t.lcZ(10,9,"submit")),t.xp6(2),t.Q6J("ngClass",t.VKq(19,f,2e3!==e.voteResult)),t.xp6(4),t.Oqu(t.lcZ(16,11,"detail"))}}let q=(()=>{class a{constructor(e,o,i,l,r,$){this.tnNodeService=e,this.spinner=o,this.dialog=i,this.router=l,this.sharedService=r,this.store=$,this.app_title="tn-node.list.title",this.app_title_fiter="tn-node.list.fiter",this.app_path_info=(new D.w).proposalTnNodeInfo,this.app_path_vote=(new D.w).proposalTnNodeVote,this.snapFilter=this.sharedService.getSnapFilter||{},this.platformList=[],this.currencyList=[],this.pagedata=[{tag:"tn-node.public.proposalCode",colunm:"proposalCode",colunmData:"proposalCode"},{tag:"tn-node.public.currencyType",colunm:"currencyType",colunmData:"currencyType"},{tag:"tn-node.public.nodeCode",colunm:"nodeCode",colunmData:"nodeCode"},{tag:"tn-node.public.nodeName",colunm:"nodeName",colunmData:"nodeName"},{tag:"tn-node.public.submission",colunm:"submitDate",colunmData:"submitDate",pip:"date"},{tag:"tn-node.public.fromVN",colunm:"fromVnName",colunmData:"fromVnName"},{tag:"tn-node.public.status",colunm:"voteResult",colunmData:"voteResult",pip:"voteResult"},{tag:"tn-node.public.myVote",colunm:"myselfResult",colunmData:"myselfResult",pip:"voteStatus"},{tag:"tn-node.list.action",colunm:"Action"}],this.dataFilter=[{name:"proposalCode",tag:"tn-node.public.proposalCode",type:"input",maxLen:24},{name:"nodeName",tag:"tn-node.public.nodeName",type:"input",maxLen:24},{name:"nodeCode",tag:"tn-node.public.nodeCode",type:"input",maxLen:24},{name:"currencyType",tag:"tn-node.public.currencyType",type:"select",option:this.currencyList},{name:"platformType",tag:"tn-node.public.platformType",type:"select",option:this.platformList},{name:"submitDate",tag:"tn-node.public.submission",type:"rangDate",startName:"startDate",endName:"endDate"},{name:"voteResult",tag:"tn-node.public.status",type:"select",option:[{label:"proposalStatus.all",val:""},{label:"proposalStatus.pending",val:0},{label:"proposalStatus.approved",val:1},{label:"proposalStatus.rejected",val:2}]}]}ngOnInit(){this.initPage(),this.loadService(this.snapFilter)}loadService(e){this.subscription=this.tnNodeService.list(e).subscribe(o=>{this.dataSource=o.data,this.total=o.resultPageInfo.total})}fetchAll(e){if(e.hasOwnProperty("type")&&"search"===e.type)return e.data.inPage={pageSize:10,pageNum:1},this.snapFilter=Object.assign(Object.assign({},this.snapFilter),e.data),void this.loadService(this.snapFilter);this.snapFilter=Object.assign(Object.assign({},this.snapFilter),e),this.loadService(this.snapFilter)}init(){this.snapFilter={},this.loadService(this.snapFilter)}onSubmit(e){this.dialog.open(A.h,{panelClass:"dialog-container-custom",data:{title:"Prompt",body:"Are you sure you want to submit this proposal?"}}).afterClosed().subscribe(i=>{i&&(this.submitSubscription=this.tnNodeService.submit({voteId:e}).subscribe(l=>{0!==l.code||this.dialog.open(A.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"Submit successfully!"}}).afterClosed().subscribe(()=>{this.init()})}))})}onJump(e,o,i){this.store.dispatch(new y.A({voteId:o,proposalCode:i})).subscribe(l=>{this.router.navigate([e])})}initPage(){this.tnNodeService.platformTypeList().subscribe(e=>{e.data.forEach(i=>{this.platformList.push({label:i.platformName,val:i.platformName})}),this.platformList.unshift({label:"ALL",val:""})}),this.tnNodeService.currencytypeList().subscribe(e=>{e.data.forEach(i=>{this.currencyList.push({label:i.currencyName,val:i.currencyName})}),this.currencyList.unshift({label:"ALL",val:""})})}ngOnDestroy(){var e;null===(e=this.subscription)||void 0===e||e.unsubscribe(),this.sharedService.setSnapFilter={}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(Z),t.Y36(T.t2),t.Y36(I.uw),t.Y36(h.F0),t.Y36(Y.F),t.Y36(v.yh))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-list"]],decls:2,vars:6,consts:[[3,"title_fiter","title","dataSource","pagedata","dataFilter","t","toParentOk","toParentCal"],[1,"flex"],[1,"c-btn"],[1,"text-blue-900","font-semibold",3,"ngClass","click"],[3,"ngClass"],[1,"text-yellow-500","font-semibold",3,"ngClass","click"],[1,"text-yellow-500","font-semibold",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"app-udpn-list",0),t.NdJ("toParentOk",function(l){return o.fetchAll(l)})("toParentCal",function(){return o.init()}),t.YNc(1,V,17,21,"ng-template"),t.qZA()),2&e&&t.Q6J("title_fiter",o.app_title_fiter)("title",o.app_title)("dataSource",o.dataSource)("pagedata",o.pagedata)("dataFilter",o.dataFilter)("t",o.total)},directives:[M.p,b.mk],pipes:[C.X$],styles:[""]}),a})();var p=s(3075),O=s(9814),Q=s(7322),w=s(8833);class m{constructor(n,e,o,i,l,r){this.spinner=n,this.formBuilder=e,this.dialog=o,this.lacation=i,this.proposalTnNodeService=l,this.store=r,this.dataShow=[],this.infoDatas={},this.form=new p.cw({}),this.initFormBuilder()}ngOnInit(){this.paramsSubscription=this.params$.subscribe(n=>{"{}"!==JSON.stringify(n.param)&&this.infoData(n.param.voteId)})}initFormBuilder(){this.form=this.formBuilder.group({myselfRemark:["",[p.kI.required]],myselfResult:["true",[p.kI.required]]})}infoData(n){this.spinner.show(),this.infoSubscription=this.proposalTnNodeService.info({voteId:n}).pipe((0,g.x)(()=>this.spinner.hide())).subscribe(e=>{this.infoDatas=e.data,this.dataShow=[[{label:"tn-node.public.proposalCode",value:e.data.proposalCode},{label:"tn-node.public.nodeName",value:e.data.nodeName}],[{label:"tn-node.public.nodeCode",value:e.data.nodeCode},{label:"tn-node.public.account",value:e.data.businessCapitalpool}],[{label:"tn-node.public.currencyType",value:e.data.currencyType},{label:"tn-node.public.precision",value:e.data.currencyPrecision}],[{label:"tn-node.public.chainFeeModel",value:1===e.data.chainFeeModel?"Fixed Fee":"Transaction Amount Ratio"},{label:"tn-node.public.serviceFee",value:1===e.data.chainFeeModel?e.data.chainFixFee:"At least:"+e.data.chainRatioFeeLeast+",At Most:"+e.data.chainRatioFeeMost+", Normal: "+e.data.chainRatioFee+"%"}],[{label:"tn-node.public.isKYC",value:e.data.businessKyc,type:"pip",pip:"isKyc"},{label:"tn-node.public.submission",value:e.data.submitDate,type:"pip",pip:"date"}],[{label:"tn-node.public.status",value:e.data.voteResult,type:"pip",pip:"voteResult"},{label:"tn-node.public.url",value:e.data.url}]]})}submit(){this.spinner.show(),this.voteSubscription=this.proposalTnNodeService.vote({myselfResult:this.form.get("myselfResult").value,proposalCode:this.infoDatas.proposalCode,myselfRemark:this.form.get("myselfRemark").value}).pipe((0,g.x)(()=>this.spinner.hide())).subscribe(n=>{0===n.code&&this.dialog.open(A.h,{panelClass:"dialog-container-custom",data:{title:"success",body:"vote successfully!"}}).afterClosed().subscribe(o=>{o&&this.lacation.back()})})}ngOnDestroy(){var n,e,o;this.store.dispatch(new y.A({})),null===(n=this.paramsSubscription)||void 0===n||n.unsubscribe(),null===(e=this.infoSubscription)||void 0===e||e.unsubscribe(),null===(o=this.voteSubscription)||void 0===o||o.unsubscribe()}}m.\u0275fac=function(n){return new(n||m)(t.Y36(T.t2),t.Y36(p.qu),t.Y36(I.uw),t.Y36(b.Ye),t.Y36(Z),t.Y36(v.yh))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-vote"]],decls:36,vars:21,consts:[["title","vote"],[3,"formGroup"],[3,"dataShow"],["tail",""],[1,"h-20"],[1,"text-right","font-sans","text-sm","font-bold","pr-3","w-1/5"],[1,"text-red-600"],["colspan","3"],["formControlName","myselfResult"],["value","true","checked","true",1,"mr-8"],["value","false",1,"second"],["appearance","outline",1,"w-full"],["matInput","","placeholder","comments","formControlName","myselfRemark",1,"!ring-transparent","h-12"],[1,"h-16"],["colspan","4",1,"text-right"],["mat-stroked-button","","color","primary","type","button","routerLink","../"],["mat-raised-button","","color","primary",1,"ml-4",3,"disabled","click"]],template:function(n,e){1&n&&(t.TgZ(0,"app-udpn-card",0),t.TgZ(1,"form",1),t.TgZ(2,"app-udpn-info",2),t.ynx(3,3),t.TgZ(4,"tr",4),t.TgZ(5,"td",5),t.TgZ(6,"span",6),t._uU(7,"*"),t.qZA(),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"td",7),t.TgZ(11,"mat-radio-group",8),t.TgZ(12,"mat-radio-button",9),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"mat-radio-button",10),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"tr"),t.TgZ(19,"td",5),t.TgZ(20,"span",6),t._uU(21,"*"),t.qZA(),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"td",7),t.ynx(25),t.TgZ(26,"mat-form-field",11),t._UZ(27,"textarea",12),t.qZA(),t.BQk(),t.qZA(),t.qZA(),t.TgZ(28,"tr",13),t.TgZ(29,"td",14),t.TgZ(30,"button",15),t._uU(31),t.ALo(32,"translate"),t.qZA(),t.TgZ(33,"button",16),t.NdJ("click",function(){return e.submit()}),t._uU(34),t.ALo(35,"translate"),t.qZA(),t.qZA(),t.qZA(),t.BQk(),t.qZA(),t.qZA(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("dataShow",e.dataShow),t.xp6(6),t.Oqu(t.lcZ(9,9,"tn-node.public.votingResult")),t.xp6(5),t.Oqu(t.lcZ(14,11,"agree")),t.xp6(3),t.Oqu(t.lcZ(17,13,"disagree")),t.xp6(6),t.Oqu(t.lcZ(23,15,"tn-node.public.comments")),t.xp6(9),t.Oqu(t.lcZ(32,17,"back")),t.xp6(2),t.Q6J("disabled",!e.form.valid),t.xp6(1),t.Oqu(t.lcZ(35,19,"save")))},directives:[F.t,p._Y,p.JL,p.sg,L.m,O.VQ,p.JJ,p.u,O.U0,Q.KE,w.Nt,p.Fj,R.lW,h.rH],pipes:[C.X$],styles:[""]}),(0,N.gn)([(0,v.Ph)(x.s.param)],m.prototype,"params$",void 0);const k=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:q},{path:"info",component:d},{path:"vote",component:m}];let B=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[h.Bz.forChild(k)],h.Bz]}),a})();var K=s(3767),z=s(8554);let j=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[b.ez,K.m,z.o,B]]}),a})()}}]);